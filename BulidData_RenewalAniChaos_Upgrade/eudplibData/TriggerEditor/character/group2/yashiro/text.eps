import PluginVariables as msqcvar;
import variable as v;
import func.trig as trg;
import func.sound as s;

const P_player			= PVariable();
const P_observer 		= PVariable();

const P_Next = PVariable();
const P_Wait = PVariable();

const P_TextTime = PVariable();

function Text(num, playerID);

function player(playerID)
{
	Text(P_player[playerID], playerID);
	P_player[playerID] = 0;
}

function observer(playerID)
{
	Text(P_observer[playerID - 128], playerID);
	P_observer[playerID - 128] = 0;
}

function main(playerID)
{
	if (playerID < 6) 	{ player(playerID); 	}
	else  			{ observer(playerID); }
	
	if (playerID < 6)
	{
		if (P_TextTime[playerID] > 0)
		{ P_TextTime[playerID] -= 1; }
		if (P_Wait[playerID] > 0)
		{ P_Wait[playerID] -= 1; }
		else if (P_Next[playerID] != 0)
		{
			P_player[playerID] 	= P_Next[playerID] + 1;
			P_observer[playerID] = P_Next[playerID] + 1;
			P_Next[playerID] = 0;
		}
	}
}

function TextDelay(playerID, wait)
{
	if (playerID < 6)
	{
		P_Next[playerID] = P_player[playerID];
		if (wait == 0)
		{ P_Next[playerID] = 0; }
		else
		{ P_Wait[playerID] = wait / 83 + 1; }
	}
}

function Text(num, playerID)
{
	switch(num)
	{
	case 1:
		PlayWAV("yashiro_o_active.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그런 게 있을 리가 없잖냐\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 2500;
		break;
	case 2:
		PlayWAV("yashiro_sss.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그것은 헛된 소망이라는 것이다\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 2200;
		break;
	case 3:
		PlayWAV("yashiro_aac.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04게임 오버다, 너도 나도\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 2600;
		break;
	case 4:
		PlayWAV("yashiro_04.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04네가 손에 넣는 것은 이 마을의 평화다\n\x13\x04네가 원한 것은 바로 그거잖아?\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 5500;
		break;
	case 5:
		PlayWAV("yashiro_05.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04내가 손에 넣는 것은\n\x13\x04내 손에 의한, 나만을 위해 존재하는 죽음이다\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 5000;
		break;
	case 6:
		PlayWAV("yashiro_ult.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04안 됐구나, 이제 시간이 없어\n");
		TextDelay(playerID, 3200);
		P_TextTime[playerID] += 6500;
		break;
	case 7:
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04이건 내게 있어서도 이판사판의 도박이었다\n");
		TextDelay(playerID, 0);
		break;
	case 1001:
		PlayWAV("yashiro_u1.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04이런 이야기를 믿어 줄 것 같진 않지만, 굳이 말하마.\n\x13\x04아니, 너라면 알아줄 지도 몰라.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 7700;
		break;
	case 1002:
		PlayWAV("yashiro_u2.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x03스파이스\x04랑 만난 이후로,\n\x13\x04나에게는 \x17거미줄\x04이 보이게 됐다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 6500;
		break;
	case 1003:
		PlayWAV("yashiro_u3.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그게 보인 인간을 죽여 왔다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 3000;
		break;
	case 1004:
		PlayWAV("yashiro_u4.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그러나 어느 날\n\x13\x04한 명의 소년이 내 계획을 저지했다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 5400;
		break;
	case 1005:
		PlayWAV("yashiro_u5.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그리고 그 소년의 머리 위에도\n\x13\x17거미줄\x04이 나타났다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 4700;
		break;
	case 1006:
		PlayWAV("yashiro_u6.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04그러나 그는 죽지 않았다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 4500;
		break;
	case 1007:
		PlayWAV("yashiro_u7.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x04나는 그 녀석을 \x03스파이스\x04라고 이름짓고\n\x13\x04관찰하기로 했다.\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 4500;
		break;
	case 1000:
		PlayWAV("yashiro_u8.ogg");
		v.stb.print("\x13\x1EYashiro Gaku\n");
		v.stb.print("\x13\x08그게 너야...\n");
		TextDelay(playerID, 0);
		P_TextTime[playerID] += 1700;
		break;
	}
}