import PluginVariables as msqcvar;
import variable as v;
import func.text as t;

const DeathOre 	= PVariable();
const Team 		= PVariable();
var ID;

function DeathText(playerID)
{
	v.stb.printAt(1,"\n\x13\x08!! Warning !!\n\x13\x19:: \x17", 
	ptr2s(t.T_CharacterName[v.P_HeroID[ID]]), "\x04이 치명상을 입었습니다. \x19::\n\n\x13\x07", 
	Team[playerID], "\x04Team \x17+ ",
	DeathOre[playerID], " \x04Ore\n");
	
	DeathOre[playerID] = 0;
	
	SetDeaths((13), (7), 0, (211));
}

function SetDeathValue(playerID)
{
	if (Deaths(CurrentPlayer, (0), 1000, (210)))
	{
		ID = playerID;
		for(var i = 0; i < 6; ++i)
		{
			DeathOre[i] = 250 + v.P_Level[playerID] * 10;
			Team[i] = playerID < 2 ? 2 : 1;
		}
		
		CenterView((96));
		
		if (playerID >= 0 && playerID <= 2)
		{
			if (Deaths((0), (10), 15, (172)) || Deaths((1), (10), 15, (172)) || Deaths((2), (10), 15, (172))) { SetSwitch((20), (4)); }
			if (Switch((22), (2)))
			{
				SetDeaths((13), (7), 12, (210)); SetSwitch((23), (4));
			}
			else { SetDeaths(CurrentPlayer, SetTo, 120 + v.P_Level[playerID] * 12, (210)); }
			if (Deaths(playerID, 10, 22, 172)) SetDeaths(playerID, SetTo, 0, " `UniqueSkill");
			SetResources((3), (8), DeathOre[playerID], (0));
			SetResources((4), (8), DeathOre[playerID], (0));
			SetResources((5), (8), DeathOre[playerID], (0));
		}
		if (playerID >= 3 && playerID <= 5)
		{
			if (Deaths((3), (10), 15, (172)) || Deaths((4), (10), 15, (172)) || Deaths((5), (10), 15, (172))) { SetSwitch((20), (4)); }
			if (Switch((22), (2)))
			{
				SetDeaths((13), (7), 12, (210)); SetSwitch((23), (4));
			}
			else { SetDeaths(CurrentPlayer, SetTo, 120 + v.P_Level[playerID] * 12, (210)); }
			if (Deaths(playerID, 10, 22, 172)) SetDeaths(playerID, SetTo, 0, " `UniqueSkill");
			SetResources((0), (8), DeathOre[playerID], (0));
			SetResources((1), (8), DeathOre[playerID], (0));
			SetResources((2), (8), DeathOre[playerID], (0));
		}
	}
	
	if (DeathOre[playerID] > 0)
	{
		DeathText(playerID);
	}
}
