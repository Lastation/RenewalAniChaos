import PluginVariables as msqcvar;
import variable as v;
import func.shape as s;

import Character.Group1.Rusaruka.Common.Skill_O as O;

const stb = StringBuffer();

function onPluginStart() 	// 초기화 함수
{
	
}

function Skill_Variable(playerID)
{
	if (v.P_WaitMain[playerID] == 0)
	{
		if 		(v.P_CountMain[playerID] == 999)	{ v.P_CountMain[playerID] = 1000; s.Main_Wait(500); }
		else if 	(v.P_CountMain[playerID] == 1000)	{ v.P_CountMain[playerID] = 0; v.P_LoopMain[playerID] = 0; v.P_SkillDelay[playerID] = 12; }
	}
	
	if 		(v.P_SkillDelay[playerID] >= 2) 	{ v.P_SkillDelay[playerID] -= 1; }
	else if 	(v.P_SkillDelay[playerID] == 1) 	{ v.P_SkillDelay[playerID] = 0; v.P_Step[playerID] = 0; }

	if (v.P_WaitMain[playerID] >= 1) { v.P_WaitMain[playerID] -= 1; }
}


function beforeTriggerExec() 
{

	randomize();
	
	// Player Loop
	foreach(Player : EUDLoopPlayer())
	{
		setcurpl(Player);
		v.P_PlayerID[Player] = Player;
		MuteUnitSpeech();
		
		v.P_CharacterID[Player] = 51;
		v.P_LocationID[Player] = 32;
		O.main(Player);
		
		Skill_Variable(Player);
		
	}
	
	// Observer Loop
	foreach (Observer : EUDLoopRange(128, 132))
	{
		setcurpl(Observer);
		MuteUnitSpeech();
	}
}