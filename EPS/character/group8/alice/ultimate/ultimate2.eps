import PluginVariables as msqcvar;
import variable as v;
import func.trig as trg;
import func.trigadv as adv;
import func.sound as s;
import func.trigepic as epic;

var x = 0;
function main(playerID)
{
	trg.Buff_ShieldFix(1);
	trg.Debuff_BanReturn();
	if(v.P_LoopMain[playerID] >= 28)
	{
		trg.Debuff_Stop();
	}
	if (v.P_WaitMain[playerID] == 0)
	{
		if(v.P_LoopMain[playerID] == 40)
		{
			MoveUnit(All,"40 + 1n Mutalisk", playerID, "Anywhere", "[Skill]HoldPosition");
		}
		if (v.P_CountMain[playerID] == 0)
		{
			KillUnitAt(All,"80 + 1n Tom Kazansky","Anywhere",playerID);
			RemoveUnitAt(All,"80 + 1n Goliath","Anywhere",playerID);
			RemoveUnitAt(All,"130 + 1n Norad","Anywhere",playerID);
			if (v.P_LoopMain[playerID] == 0)
			{
				trg.Main_Wait(400);	
			}
			
			else if (v.P_LoopMain[playerID] <= 10)
			{
				trg.Shape_Line(playerID,1,"Zerg Devourer",0+30*v.P_LoopMain[playerID],2,640-v.P_LoopMain[playerID]*64,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",90+30*v.P_LoopMain[playerID],2,640-v.P_LoopMain[playerID]*64,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",45+30*v.P_LoopMain[playerID],2,640-v.P_LoopMain[playerID]*64,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",135+30*v.P_LoopMain[playerID],2,640-v.P_LoopMain[playerID]*64,0);
				KillUnitAt(All,"Zerg Devourer","Anywhere",playerID);
				trg.Main_Wait(160);
			}
			else if (v.P_LoopMain[playerID] <= 25)
			{
				trg.Shape_Line(playerID,1,"Zerg Devourer",0+30*v.P_LoopMain[playerID],2,0+x,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",90+30*v.P_LoopMain[playerID],2,0+x,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",45+30*v.P_LoopMain[playerID],2,0+x,0);
				trg.Shape_Line(playerID,1,"Zerg Devourer",135+30*v.P_LoopMain[playerID],2,0+x,0);
				x += 48;
				KillUnitAt(All,"Zerg Devourer","Anywhere",playerID);
				trg.Main_Wait(160);
			}
			else if(v.P_LoopMain[playerID] == 26)
			{
				x = 0;
				trg.Main_Wait(1300);
			}
			else if(v.P_LoopMain[playerID] == 27)
			{
				trg.Shape_Edge(playerID,1,"60 + 1n Siege",45,5,96);
				trg.Shape_Edge(playerID,1,"130 + 1n Arbiter",45,5,96);
				KillUnitAt(All,"130 + 1n Arbiter","Anywhere",playerID);
				if (playerID < 3)
				{
					GiveUnits(All,"60 + 1n Siege", CurrentPlayer, "Anywhere", P9);
				}
				else
				{
					GiveUnits(All,"60 + 1n Siege", CurrentPlayer, "Anywhere", P9);
				}
				trg.Main_Wait(1000);
			}
			
			else if(v.P_LoopMain[playerID] == 28)
			{
				trg.Shape_Edge(playerID,1,"60 + 1n Siege",45,9,192);
				trg.Shape_Edge(playerID,1,"130 + 1n Arbiter",45,9,192);
				KillUnitAt(All,"130 + 1n Arbiter","Anywhere",playerID);
				if (playerID < 3)
				{
					GiveUnits(All,"60 + 1n Siege", CurrentPlayer, "Anywhere", P9);
				}
				else
				{
					GiveUnits(All,"60 + 1n Siege", CurrentPlayer, "Anywhere", P9);
				}
				trg.Main_Wait(1000);
			}
			else if(v.P_LoopMain[playerID] == 29)
			{
				trg.Shape_Edge(playerID,1,"60 + 3n Siege",45,13,288);
				trg.Shape_Edge(playerID,1,"130 + 1n Arbiter",45,13,288);
				KillUnitAt(All,"130 + 1n Arbiter","Anywhere",playerID);
				if (playerID < 3)
				{
					GiveUnits(All,"60 + 3n Siege", CurrentPlayer, "Anywhere", P9);
				}
				else
				{
					GiveUnits(All,"60 + 3n Siege", CurrentPlayer, "Anywhere", P9);
				}
				trg.Main_Wait(1400);
			}
			else if(v.P_LoopMain[playerID] == 30)
			{
				if (playerID < 3)
				{
					GiveUnits(All,"60 + 3n Siege", P9, "Anywhere", CurrentPlayer);
					GiveUnits(All,"60 + 1n Siege", P9, "Anywhere", CurrentPlayer);
				}
				else
				{
					GiveUnits(All,"60 + 3n Siege", P9, "Anywhere", CurrentPlayer);
					GiveUnits(All,"60 + 1n Siege", P9, "Anywhere", CurrentPlayer);
				}
				trg.Shape_NxNSquare(playerID,1,"40 + 3n Zeratul",8,64);
				KillUnitAt(All,"60 + 1n Siege","Anywhere",playerID);
				trg.MoveLoc(v.P_UnitID[playerID], playerID, 0, 0);
				Order("40 + 3n Zeratul", playerID, "Anywhere",Attack, v.P_LocationID[playerID]);
				trg.Main_Wait(1000);
			}
			
			else if(v.P_LoopMain[playerID] <= 60)
			{
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,640,0);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,512,0);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,384,0);
				
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,640,64);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,512,64);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,384,64);
				
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,640,128);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,512,128);
				trg.Shape_Line(playerID,1,"130 + 1n Norad",0+30*v.P_LoopMain[playerID],2,384,128);
				
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,640,0);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,512,0);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,256,0);
				
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,640,64);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,512,64);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,384,64);
				
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,640,128);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,512,128);
				trg.Shape_Line(playerID,1,"60 + 1n Archon",0+30*v.P_LoopMain[playerID],2,384,128);
				
				trg.Shape_NxNSquare(playerID,1,"130 + 1n Norad",3,64);
				trg.Shape_Edge(playerID,1,"60 + 1n Archon",45,3,64);
				KillUnitAt(All,"60 + 1n Archon","Anywhere",playerID);
				KillUnitAt(All,"130 + 1n Norad","Anywhere",playerID);
				//trg.MoveLoc(v.P_UnitID[playerID], playerID, 0, 0);
				//Order("130 + 1n Norad", playerID, "Anywhere",Attack, v.P_LocationID[playerID]);
				trg.Main_Wait(80);
			}
			else if(v.P_LoopMain[playerID] == 61)
			{
				KillUnitAt(All,"60 + 3n Siege","Anywhere",playerID);
				KillUnitAt(All,"40 + 3n Zeratul","Anywhere",playerID);
				trg.Shape_NxNSquare(playerID,1,"130 + 1n Norad",8,64);
				trg.Shape_NxNSquare(playerID,1,"80 + 1n Goliath",8,64);
				trg.MoveLoc(v.P_UnitID[playerID], playerID, 0, 0);
				Order("130 + 1n Norad", playerID, "Anywhere",Attack, v.P_LocationID[playerID]);
				Order("80 + 1n Goliath", playerID, "Anywhere",Attack, v.P_LocationID[playerID]);
				trg.Main_Wait(300);
			}
			else if(v.P_LoopMain[playerID] == 62)
			{
				SetSwitch("UiltimateSwitch", Clear);
				trg.SkillEnd();
			}
			v.P_LoopMain[playerID] += 1;
		}
	}
}