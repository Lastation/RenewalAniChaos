import PluginVariables as msqcvar;
import variable as v;
import func.trig as trg;
import func.sound as s;
import func.trigepic as epic;

var x = 0;
function main(playerID)
{
	trg.Buff_ShieldFix(1);
	
	if(v.P_LoopMain[playerID] < 34)
	{
		trg.Debuff_Stop();
	}	
	if(v.P_LoopMain[playerID] < 15)
		{
			MoveUnit(All,"50 + 1n Battlecruiser", playerID, "Anywhere", "[Skill]HoldPosition");
		}
	MoveUnit(All,"50 + 1n Tank", playerID, "Anywhere", "[Skill]HoldPosition");
	MoveUnit(All,"40 + 1n Goliath", playerID, "Anywhere", "[Skill]HoldPosition");
	if (v.P_WaitMain[playerID] == 0)
	{
		if (v.P_CountMain[playerID] == 0)
		{
			RemoveUnitAt(All,"40 + 1n Wraith","Anywhere",playerID);
			RemoveUnitAt(All,"40 + 1n Lurker","Anywhere",playerID);
			if(v.P_LoopMain[playerID] > 54)
			{
				KillUnitAt(All,"60 + 1n Danimoth","Anywhere",playerID);
			}
			if (v.P_LoopMain[playerID] <= 4)
			{
				if (Bring(playerID, AtLeast, 1, v.P_UnitID[playerID], "[Map]Team2"))
				{ SetAllianceStatus(P8, Ally); }
				if (Bring(playerID, AtLeast, 1, v.P_UnitID[playerID], "[Map]Team1"))
				{ SetAllianceStatus(P7, Ally); }
			
				trg.Shape_Double(playerID,1,"40 + 1n Wraith",48+48*x,0);
				trg.Shape_Double(playerID,1,"40 + 1n Gantrithor",48+48*x,0);
				KillUnitAt(All,"40 + 1n Gantrithor","Anywhere",playerID);
				trg.MoveLoc(v.P_UnitID[playerID],playerID,0,0);
				Order("40 + 1n Wraith",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				x+= 1;
				trg.Main_Wait(160);
			}
			else if (v.P_LoopMain[playerID] == 5)
			{
				x = 0;
				trg.Shape_Double(playerID,1,"50 + 1n Battlecruiser",288,0);
				trg.Main_Wait(640);
			}
			else if (v.P_LoopMain[playerID] == 6)
			{
				trg.Shape_Double(playerID,1,"50 + 1n Tank",352,32);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",352,-32);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",352,96);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",352,-96);
				
				trg.Shape_Double(playerID,1,"50 + 1n Tank",288,96);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",288,-96);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",224,96);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",224,-96);
			
				trg.Shape_Double(playerID,1,"50 + 1n Tank",160,32);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",160,-32);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",160,96);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",160,-96);
				
				trg.Shape_Double(playerID,1,"Protoss Observer",352,32);
				trg.Shape_Double(playerID,1,"Protoss Observer",352,-32);
				trg.Shape_Double(playerID,1,"Protoss Observer",352,96);
				trg.Shape_Double(playerID,1,"Protoss Observer",352,-96);
				
				trg.Shape_Double(playerID,1,"Protoss Observer",288,96);
				trg.Shape_Double(playerID,1,"Protoss Observer",288,-96);
				trg.Shape_Double(playerID,1,"Protoss Observer",224,96);
				trg.Shape_Double(playerID,1,"Protoss Observer",224,-96);
			
				trg.Shape_Double(playerID,1,"Protoss Observer",160,32);
				trg.Shape_Double(playerID,1,"Protoss Observer",160,-32);
				trg.Shape_Double(playerID,1,"Protoss Observer",160,96);
				trg.Shape_Double(playerID,1,"Protoss Observer",160,-96);
				KillUnitAt(All,"Protoss Observer","Anywhere",playerID);
				trg.Main_Wait(320);
			}
			else if (v.P_LoopMain[playerID] == 7)
			{
				trg.Main_Wait(1280);
			}
			else if(v.P_LoopMain[playerID] <= 12)
			{
				trg.Shape_Double(playerID,1,"40 + 1n Wraith",0,48+48*x);
				trg.Shape_Double(playerID,1,"130 + 1n Norad",0,48+48*x);
				KillUnitAt(All,"130 + 1n Norad","Anywhere",playerID);
				trg.MoveLoc(v.P_UnitID[playerID],playerID,0,0);
				Order("40 + 1n Wraith",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				x+= 1;
				trg.Main_Wait(160);
			}
			else if(v.P_LoopMain[playerID] == 13)
			{
				x = 0;
				trg.Shape_Double(playerID,1,"50 + 1n Battlecruiser",0,288);
				trg.Main_Wait(560);
			}
			else if (v.P_LoopMain[playerID] == 14)
			{
				trg.Shape_Double(playerID,1,"50 + 1n Tank",32,352);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-32,352);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",96,352);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-96,352);
				
				trg.Shape_Double(playerID,1,"50 + 1n Tank",96,288);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-96,288);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",96,224);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-96,224);
			
				trg.Shape_Double(playerID,1,"50 + 1n Tank",32,160);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-32,160);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",96,160);
				trg.Shape_Double(playerID,1,"50 + 1n Tank",-96,160);
				
				trg.Shape_Double(playerID,1,"Zerg Overlord",32,352);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-32,352);
				trg.Shape_Double(playerID,1,"Zerg Overlord",96,352);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-96,352);
				
				trg.Shape_Double(playerID,1,"Zerg Overlord",96,288);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-96,288);
				trg.Shape_Double(playerID,1,"Zerg Overlord",96,224);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-96,224);
			
				trg.Shape_Double(playerID,1,"Zerg Overlord",32,160);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-32,160);
				trg.Shape_Double(playerID,1,"Zerg Overlord",96,160);
				trg.Shape_Double(playerID,1,"Zerg Overlord",-96,160);
				KillUnitAt(All,"Zerg Overlord","Anywhere",playerID);
				trg.Main_Wait(1040);
			}
			else if(v.P_LoopMain[playerID] <= 31)
			{
				trg.Shape_Double(playerID,1,"60 + 1n Archon",288-18*x,0);
				trg.Shape_Double(playerID,1,"Protoss Dark Archon",0,288-18*x);
				MoveLocation(v.P_LocationID[playerID], v.P_UnitID[playerID], playerID, "Anywhere");
				trg.MoveLoc(v.P_UnitID[playerID],playerID,0,0);
				x+= 1;
				Order("50 + 1n Battlecruiser",playerID,"Anywhere",Move,v.P_LocationID[playerID]);
				KillUnitAt(All,"60 + 1n Archon","Anywhere",playerID);
				KillUnitAt(All,"Protoss Dark Archon","Anywhere",playerID);
				trg.Main_Wait(160);
			}
			else if(v.P_LoopMain[playerID] == 32)
			{
				trg.Main_Wait(400);
			}
			else if(v.P_LoopMain[playerID] == 33)
			{	
				x = 0;
				MoveLocation(v.P_LocationID[playerID], v.P_UnitID[playerID], playerID, "Anywhere");
				RemoveUnitAt(All,"50 + 1n Battlecruiser","Anywhere",playerID);
				trg.Shape_Edge(playerID,1,"40 + 1n Gantrithor",45,5,128);
				trg.Shape_NxNSquare(playerID,1,"130 + 1n Norad",3,64);
				KillUnitAt(All,"40 + 1n Gantrithor","Anywhere",playerID);
				KillUnitAt(All,"130 + 1n Norad","Anywhere",playerID);
				trg.Shape_Edge(playerID,1,"60 + 1n Hydralisk",45,4,64);
				trg.Main_Wait(2240);
			}
			
			else if(v.P_LoopMain[playerID] <= 45)
			{
				KillUnitAt(4,"50 + 1n Tank","Anywhere",playerID);
				KillUnitAt(1,"60 + 1n Hydralisk","Anywhere",playerID);
				trg.Main_Wait(160);
			}
			else if(v.P_LoopMain[playerID] == 46)
			{
				trg.Main_Wait(240);
			}
			else if(v.P_LoopMain[playerID] <= 51)
			{
				trg.Shape_Edge(playerID,1,"130 + 1n Norad",45,1+2*x,64+80*x);
				KillUnitAt(All,"130 + 1n Norad","Anywhere",playerID);
				trg.Shape_Edge(playerID,1,"50 + 1n Tank",45,1+2*x,64+80*x);
				trg.Shape_Edge(playerID,1,"40 + 1n Goliath",45,1+2*x,64+80*x);
				if(v.P_LoopMain[playerID] % 2 == 0)
				{
					trg.Shape_Edge(playerID,1,"50 + 1n Battlecruiser",45,1+2*x,64+80*x);
				}
				else
				{
					trg.Shape_Edge(playerID,1,"60 + 1n Danimoth",45,1+2*x,64+80*x);
				}	
				trg.MoveLoc(v.P_UnitID[playerID],playerID,0,0);
				Order("50 + 1n Battlecruiser",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				Order("60 + 1n Danimoth",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				Order("40 + 1n Goliath",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				x += 1;
				trg.Main_Wait(80);
			}
			
			else if(v.P_LoopMain[playerID] == 52)
			{
				x = 0;
				trg.Main_Wait(2000);
			}
			else if(v.P_LoopMain[playerID] == 53)
			{
				KillUnitAt(All,"50 + 1n Battlecruiser","Anywhere",playerID);
				KillUnitAt(All,"60 + 1n Danimoth","Anywhere",playerID);
				trg.Main_Wait(1440);
			}
			else if(v.P_LoopMain[playerID] == 54)
			{
				trg.Main_Wait(1200);
			}
			else if(v.P_LoopMain[playerID] <= 62)
			{
				for(var i =0; i < 10; i++)
				{
					MoveLocation(v.P_LocationID[playerID],"50 + 1n Tank",playerID,"Anywhere");
					RemoveUnitAt(1,"50 + 1n Tank","Anywhere",playerID);
					trg.SkillUnit(playerID,2,"60 + 1n Danimoth");
					trg.SkillUnit(playerID,1,"50 + 1n Battlecruiser");
					KillUnitAt(All,"50 + 1n Battlecruiser","Anywhere",playerID);
					KillUnitAt(1,"40 + 1n Goliath","Anywhere",playerID);
					
				}
				MoveLocation(v.P_LocationID[playerID], v.P_UnitID[playerID], playerID, "Anywhere");
				trg.MoveLoc(v.P_UnitID[playerID],playerID,0,0);
				Order("60 + 1n Danimoth",playerID,"Anywhere",Attack,v.P_LocationID[playerID]);
				trg.Main_Wait(160);
			}
			else if(v.P_LoopMain[playerID] == 63)
			{
				
				KillUnitAt(All,"40 + 1n Goliath","Anywhere",playerID);
				RemoveUnitAt(All,"50 + 1n Tank","Anywhere",playerID);
				trg.SkillEnd();
			}
			
			v.P_LoopMain[playerID] += 1;
		}
	}
}