import PluginVariables as msqcvar;
import func.shape as s;

function main(playerID)
{
	if (s.wait[playerID] == 0 && s.step[playerID] == 0)
	{
		if (Bring(playerID, AtLeast, 1, "Protoss Corsair", "[Skill]UseSkill"))
		{
			KillUnitAt(1, "Protoss Corsair", "[Skill]UseSkill", playerID);
			if (Switch("Unique - Chtholly", Cleared))
			{ 
				SetSwitch("Unique - Chtholly", Set); 
				s.stb.printAt(8, "\x13\x04전투속행 패시브를 \x1CON \x04시킵니다.");
			}
			else 
			{ 
				SetSwitch("Unique - Chtholly", Clear); 
				s.stb.printAt(8, "\x13\x04전투속행 패시브를 \x08OFF \x04시킵니다.");
			}
		}
		if (Bring(playerID, AtLeast, 1, "Protoss Scout", "[Skill]UseSkill"))
		{
			s.step[playerID] = 100;
			KillUnitAt(1, "Protoss Scout", "[Skill]UseSkill", playerID);
		}
		else if (Bring(playerID, AtLeast, 1, "Protoss Carrier", "[Skill]UseSkill"))
		{
			s.step[playerID] = 200;
			KillUnitAt(1, "Protoss Carrier", "[Skill]UseSkill", playerID);
		}
		else if (Bring(playerID, AtLeast, 1, "Protoss Arbiter", "[Skill]UseSkill"))
		{
			s.step[playerID] = 300;
			KillUnitAt(1, "Protoss Arbiter", "[Skill]UseSkill", playerID);
		}
	}
	
	// Combo
	if (s.wait[playerID] >= 2 && v.P_CountMain[playerID] == 0)
	{
		if (Bring(playerID, AtLeast, 2, "Protoss Scout", "[Skill]UseSkill") &&  s.step[playerID] == 100)
		{
			s.Voice_Routine(playerID, 9);
			s.wait[playerID] = 0;
			s.step[playerID] = 110;
			KillUnitAt(2, "Protoss Scout", "[Skill]UseSkill", playerID);
		}
		
		else if (Bring(playerID, AtLeast, 1, "Protoss Carrier", "[Skill]UseSkill") 
		&& Bring(playerID, AtLeast, 1, "Protoss Arbiter", "[Skill]UseSkill") &&  s.step[playerID] == 200)
		{
			s.Voice_Routine(playerID, 1);
			s.wait[playerID] = 0;
			s.step[playerID] = 210;
			KillUnitAt(1, "Protoss Carrier", "[Skill]UseSkill", playerID);
			KillUnitAt(1, "Protoss Arbiter", "[Skill]UseSkill", playerID);
		}
		
		// Ultimate
		else if (Bring(playerID, AtLeast, 3, "Protoss Arbiter", "[Skill]UseSkill") 
		&& s.step[playerID] == 300
		&& Deaths(playerID, AtLeast, s.UltimateB[playerID], " `UltimateCoolTime"))
		{
			if (Switch("UiltimateSwitch", Cleared))
			{
				s.Voice_Routine(playerID, 11);
				SetSwitch("UiltimateSwitch", Set);
				s.wait[playerID] = 0;
				s.step[playerID] = 240;
				v.P_LoopMainB[playerID] = 1;
				SetDeaths(playerID, Subtract, s.UltimateB[playerID], " `UltimateCoolTime");
				KillUnitAt(3, "Protoss Arbiter", "[Skill]UseSkill", playerID);
				SetSwitch("Recall - Chtholly", Set);
			}
			else
			{
				SetResources(CurrentPlayer, Add, 900, Gas);
				KillUnitAt(3, "Protoss Arbiter", "[Skill]UseSkill", playerID);
				SetDeaths(CurrentPlayer, SetTo, 999, " `SYSTEMTEXT");
			}
		}
	}
}